# åŸºäº ESLint 9 å‰ç«¯å·¥ç¨‹è§„èŒƒåŒ–æœ€ä½³å®è·µ

## é¡¹ç›®é‡Œæœ‰è€ƒè™‘è¿‡è§„èŒƒåŒ–ç›¸å…³å†…å®¹å— â“

### æ€ä¹ˆç†è§£é¡¹ç›®è§„èŒƒåŒ–ï¼ŸğŸ§

> [!tip] ğŸ“– å®šä¹‰
> é¡¹ç›®è§„èŒƒåŒ–å°±æ˜¯åœ¨å›¢é˜Ÿå¼€å‘è¿‡ç¨‹ä¸­ï¼ŒæŒ‰ç…§ä¸€æ ·çš„æŠ€æœ¯ã€ç¼–ç é£æ ¼ã€ç›®å½•ç»“æ„å’Œä»£ç è´¨é‡æ ‡å‡†

> [!important] ğŸ“Œ è§„èŒƒåŒ–çš„æ ¸å¿ƒç›®æ ‡
>
> - å°½å¯èƒ½æé«˜é¡¹ç›®çš„å¯ç»´æŠ¤æ€§ã€ä¸€è‡´æ€§å’Œå¯è¯»æ€§
> - å°½å¯èƒ½å‡å°‘å›¢é˜Ÿæˆå‘˜ä¹‹é—´å› ä¸ºä»£ç é£æ ¼æˆ–è§„åˆ™ä¸ç»Ÿä¸€è€Œäº§ç”Ÿçš„æ²Ÿé€šæˆæœ¬

#### è§„èŒƒåŒ–çš„å±‚é¢

é¡¹ç›®è§„èŒƒåŒ–ä¸ä»…ä»…ä½“ç°åœ¨ä»£ç å±‚é¢ï¼Œè¿˜åŒ…æ‹¬å¤šä¸ªæ–¹é¢

- **æ–‡ä»¶ç»“æ„**ï¼šåˆç†çš„é¡¹ç›®ç›®å½•å’Œæ–‡ä»¶ç»„ç»‡æ–¹å¼ï¼Œç¡®ä¿æ¯ä¸ªæ¨¡å—éƒ½èƒ½å¿«é€Ÿå®šä½

- **å‘½åè§„åˆ™**ï¼šç»Ÿä¸€çš„å˜é‡ã€å‡½æ•°ã€æ–‡ä»¶å‘½åè§„èŒƒï¼Œç¡®ä¿ä»£ç æ¸…æ™°ï¼Œå®¹æ˜“ç†è§£

- **æäº¤è§„èŒƒ**ï¼šä»£ç æäº¤æ—¶çš„æ ¼å¼è¦æ±‚ï¼ŒåŒ…æ‹¬æäº¤ä¿¡æ¯çš„è§„èŒƒåŒ–ï¼Œä»¥ä¾¿å›¢é˜Ÿæˆå‘˜å¿«é€Ÿäº†è§£æ¯æ¬¡æäº¤çš„ç›®çš„å’Œå†…å®¹

### ä»£ç è§„èŒƒåŒ–

#### ä»€ä¹ˆæ˜¯ ESLintï¼ŸğŸ§

> [!tip] ğŸ“– å®šä¹‰
> ESLint æ˜¯ä¸€æ¬¾ JavaScript å’Œ TypeScript çš„ä»£ç è´¨é‡æ£€æŸ¥å·¥å…·ï¼Œå¸®åŠ©å¼€å‘è€…ç¡®ä¿ä»£ç åœ¨è¯­æ³•ã€é€»è¾‘ã€é£æ ¼ç­‰æ–¹é¢ç¬¦åˆæ—¢å®šçš„è§„åˆ™

ESLint å¯ä»¥ä¸ºé¡¹ç›®æä¾›çµæ´»çš„é…ç½®ï¼Œé€‚åº”ä¸åŒå›¢é˜Ÿçš„éœ€æ±‚

#### ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ ESLintï¼ŸğŸ§

ESLint ä¸»è¦ä½œç”¨æ˜¯åŠæ—¶å‘ç°æ½œåœ¨çš„ä»£ç é”™è¯¯ï¼Œæå‡ä»£ç è´¨é‡

é€šè¿‡å¯¹ä»£ç é£æ ¼çš„ç»Ÿä¸€ï¼ŒESLint è¿˜èƒ½å¤Ÿå‡å°‘å›¢é˜Ÿæˆå‘˜ä¹‹é—´çš„æ²Ÿé€šæˆæœ¬å’Œå¼€å‘å†²çª

#### ESLint çš„æ ¸å¿ƒåŸç†

> [!important] ğŸ”” é‡ç‚¹
> ESLint é€šè¿‡æŠ½è±¡è¯­æ³•æ ‘ï¼ˆASTï¼‰åˆ†æä»£ç ï¼Œå°†ä»£ç è½¬æ¢ä¸ºä¸€ä¸ªæ ‘çŠ¶ç»“æ„ï¼Œé€šè¿‡åˆ†ææ ‘çš„èŠ‚ç‚¹ï¼Œè¯†åˆ«å‡ºä¸ç¬¦åˆè§„åˆ™çš„éƒ¨åˆ†

è¿™ç§åŸºäºç»“æ„åŒ–æ•°æ®çš„æ£€æŸ¥æ–¹å¼ä½¿å¾— ESLint èƒ½å¤Ÿç²¾ç¡®åœ°æ£€æŸ¥ä»£ç çš„å„ä¸ªç»†èŠ‚

#### ESLint è§„åˆ™çº¦å®š

- **off**ï¼šå…³é—­è§„åˆ™ï¼ŒESLint ä¸ä¼šè¿›è¡Œä»»ä½•æ£€æŸ¥

- **warn**ï¼šè­¦å‘Šçº§åˆ«ï¼Œè¿åè§„åˆ™æ—¶ä¼šæ˜¾ç¤ºè­¦å‘Šï¼Œä½†ä¸ä¼šé˜»æ­¢ä»£ç è¿è¡Œ

- **error**ï¼šé”™è¯¯çº§åˆ«ï¼Œè¿åè§„åˆ™æ—¶ä¼šæŠ¥é”™ï¼Œå¸¸ç”¨äºå›¢é˜Ÿå¿…é¡»éµå¾ªçš„è§„èŒƒ

##### æ ¸å¿ƒè§„åˆ™è®²è§£

- **è¯­æ³•æ£€æŸ¥**ï¼šç¡®ä¿ä»£ç ç¬¦åˆè¯­æ³•è§„èŒƒï¼Œå¦‚ç¦æ­¢ä½¿ç”¨æœªå®šä¹‰çš„å˜é‡æˆ–é‡å¤å£°æ˜å˜é‡

- **é£æ ¼ä¸€è‡´æ€§**ï¼šç¡®ä¿ä»£ç é£æ ¼ç»Ÿä¸€ï¼Œå¦‚å¼ºåˆ¶ä½¿ç”¨åˆ†å·ã€ç»Ÿä¸€çš„ç©ºæ ¼å’Œç¼©è¿›è§„åˆ™

- **æœ€ä½³å®è·µ**ï¼šå¦‚ç¦æ­¢ä½¿ç”¨`eval()`å‡½æ•°ï¼Œé¿å…åŸå‹æ±¡æŸ“ç­‰ï¼Œä»¥å‡å°‘æ½œåœ¨çš„å®‰å…¨éšæ‚£

### å›¢é˜Ÿåä½œä¸ä»£ç é£æ ¼ç»Ÿä¸€

#### âœ… ESLint ä¸ Prettier çš„é›†æˆ

ESLint ä¸“æ³¨äºä»£ç çš„è¯­æ³•å’Œé€»è¾‘æ£€æŸ¥ï¼Œè€Œ Prettier ä¸“æ³¨äºä»£ç çš„æ ¼å¼åŒ–

é€šè¿‡å°† ESLint å’Œ Prettier ç»“åˆä½¿ç”¨ï¼Œå›¢é˜Ÿå¯ä»¥ç¡®ä¿ä»£ç åœ¨åŠŸèƒ½å’Œé£æ ¼ä¸Šçš„ä¸€è‡´æ€§ï¼Œä»è€Œå‡å°‘ä¸å¿…è¦çš„å›¢é˜Ÿå†²çª

> [!tip] ğŸ˜ ä»£ç é£æ ¼ç»Ÿä¸€çš„ç›Šå¤„
> é€šè¿‡è‡ªåŠ¨åŒ–çš„ä»£ç é£æ ¼ç»Ÿä¸€ï¼Œå›¢é˜Ÿæˆå‘˜æ— éœ€ä¸ºä»£ç æ ¼å¼è¿›è¡Œäº‰è®ºï¼ŒPR å®¡æŸ¥æ›´åŠ é«˜æ•ˆï¼Œå¼€å‘è€…å¯ä»¥å°†ç²¾åŠ›é›†ä¸­åœ¨ä¸šåŠ¡é€»è¾‘å’Œæ¶æ„ä¼˜åŒ–ä¸Š

### å®é™…é¡¹ç›®ä¸­çš„ ESLint å®è·µ

#### âœ… è§„åˆ™é›†é€‰æ‹©

åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œå›¢é˜Ÿå¯ä»¥æ ¹æ®é¡¹ç›®è§„æ¨¡å’Œæˆå‘˜æ•°é‡é€‰æ‹©åˆé€‚çš„è§„åˆ™é›†

å¯¹äºå¤§å‹é¡¹ç›®ï¼Œå¯ä»¥ä½¿ç”¨åƒ Airbnb è¿™æ ·çš„ä¸¥æ ¼è§„åˆ™é›†ï¼Œè€Œå°å‹é¡¹ç›®å¯ä»¥ä½¿ç”¨ ESLint æ¨èçš„çµæ´»é…ç½®

#### âœ… å¤§å‹å›¢é˜Ÿçš„ ESLint é…ç½®æŠ€å·§

åœ¨å¤§å‹é¡¹ç›®ä¸­ï¼Œå¯èƒ½æ¶‰åŠå¤šä¸ªå­é¡¹ç›®æˆ–æ¨¡å—ï¼Œå¯ä»¥é€šè¿‡`overrides`é€‰é¡¹ï¼Œä¸ºä¸åŒæ¨¡å—é…ç½®ä¸åŒçš„è§„åˆ™

ä¾‹å¦‚ï¼Œå¯ä»¥ä¸ºåç«¯æ¨¡å—å…è®¸`console.log`ï¼Œè€Œå‰ç«¯æ¨¡å—åˆ™ç¦ç”¨æ­¤è§„åˆ™ï¼Œç¡®ä¿ä¸€è‡´æ€§

#### âœ… è‡ªåŠ¨åŒ–ä¸ ESLint çš„é›†æˆ

**Git Hooks**

- é€šè¿‡ husky å’Œ lint-stagedï¼Œå¯ä»¥åœ¨æ¯æ¬¡ Git æäº¤ä¹‹å‰æ£€æŸ¥ä»£ç ï¼Œç¡®ä¿ä¸ç¬¦åˆè§„èŒƒçš„ä»£ç ä¸ä¼šè¢«æäº¤

**CI/CD é›†æˆ**

- åœ¨ CI/CD æµç¨‹ä¸­é›†æˆ ESLintï¼Œç¡®ä¿æ¯æ¬¡ä»£ç åˆå¹¶æ—¶éƒ½èƒ½ç¬¦åˆé¡¹ç›®è§„èŒƒï¼Œä»è€Œæœ‰æ•ˆå‡å°‘ä»£ç å®¡æŸ¥çš„å¤æ‚åº¦å’Œæ—¶é—´æˆæœ¬

> [!tip] ğŸ˜ è‡ªåŠ¨åŒ–çš„ä»·å€¼
> è‡ªåŠ¨åŒ– ESLint æ£€æŸ¥ä¸ä»…å‡å°‘äº†äººä¸ºç–å¿½çš„å¯èƒ½æ€§ï¼Œè¿˜æé«˜äº†é¡¹ç›®çš„ä¸€è‡´æ€§ï¼Œé¿å…äº†ä»£ç é£æ ¼å’Œé€»è¾‘ä¸ç»Ÿä¸€çš„é—®é¢˜

### å›¢é˜Ÿé¡¹ç›®è§„èŒƒåŒ–æ¨è¿›ç»†èŠ‚

> [!important] ğŸ’¯ æœ€ä½³å®è·µ
> åœ¨é¡¹ç›®ä¸­é€æ­¥å¼•å…¥ ESLint è§„èŒƒï¼Œä»å®½æ¾åˆ°ä¸¥æ ¼çš„è¿‡æ¸¡ï¼Œé¿å…å›¢é˜Ÿæˆå‘˜äº§ç”ŸæŠµè§¦æƒ…ç»ª
>
> å»ºè®®å…ˆè®©å›¢é˜Ÿç†Ÿæ‚‰æ ¸å¿ƒè§„åˆ™ï¼Œå†é€æ­¥åŠ å¼ºè§„åˆ™çš„ä¸¥æ ¼ç¨‹åº¦

> [!warning] âš ï¸ å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ³•
> ä¾‹å¦‚ï¼Œå›¢é˜Ÿæˆå‘˜å¯¹ä»£ç é£æ ¼å­˜åœ¨åˆ†æ­§æ—¶ï¼Œå¯ä»¥åˆ©ç”¨ Prettier å’Œ ESLint æ¥ç»Ÿä¸€é£æ ¼ï¼Œä»è€Œå‡å°‘äººä¸ºçš„å¹²é¢„å’Œæ‘©æ“¦

## ESLint æˆ–è€… Oxlint æœ‰æ·±å…¥å®è·µç»éªŒå— â“

åœ¨å‰ç«¯å¼€å‘è¿‡ç¨‹ä¸­ï¼Œä»£ç é£æ ¼å’Œè´¨é‡çš„ç»Ÿä¸€æ€§ï¼Œå¯¹å›¢é˜Ÿåä½œå’Œä»£ç ç»´æŠ¤è‡³å…³é‡è¦ï¼Œä¸ºäº†æé«˜ä»£ç çš„ä¸€è‡´æ€§ã€å¯è¯»æ€§ï¼Œå‡å°‘é”™è¯¯ï¼Œå¹¶ä¸”åœ¨åæœŸç»´æŠ¤ä¸­æ›´é«˜æ•ˆï¼Œæˆ‘ä»¬å›¢é˜Ÿå¼•å…¥äº†ç¼–ç è§„èŒƒåŒ–

æˆ‘ä»¬é€‰æ‹©äº† ESLint ä½œä¸ºä»£ç è´¨é‡æ£€æµ‹å·¥å…·ï¼Œå®ƒæ”¯æŒ JavaScriptã€TypeScript åŠ Vue ç­‰å¤šç§å¼€å‘ç¯å¢ƒ

### JavaScript é¡¹ç›®çš„ ESLint é…ç½®

#### åŸºç¡€é…ç½®

åœ¨ JavaScript é¡¹ç›®ä¸­ï¼Œé€šè¿‡ ESLint çš„åŸºç¡€é…ç½®æ¥æ£€æŸ¥å¸¸è§çš„ä»£ç é—®é¢˜ï¼Œå¦‚æœªå®šä¹‰å˜é‡ã€æœªä½¿ç”¨å˜é‡ç­‰ï¼Œä»è€Œæå‰è§„é¿é”™è¯¯ï¼Œæå‡ä»£ç è´¨é‡

ä»¥ä¸‹æ˜¯æˆ‘ä»¬ä¸º JavaScript é¡¹ç›®é…ç½®çš„åŸºç¡€ ESLint è§„åˆ™

```js
export default {
  rules: {
    'no-console': 'error', // ç¦æ­¢ä½¿ç”¨ consoleï¼Œé¿å…åœ¨ç”Ÿäº§ç¯å¢ƒä¸­è¾“å‡ºè°ƒè¯•ä¿¡æ¯
    'no-unused-vars': 'error', // ç¦æ­¢æœªä½¿ç”¨çš„å˜é‡ï¼Œç¡®ä¿ä»£ç ä¸­æ‰€æœ‰å£°æ˜çš„å˜é‡éƒ½æœ‰å®é™…ç”¨é€”
    'no-sparse-arrays': 'error', // é¿å…ç¨€ç–æ•°ç»„ï¼Œé˜²æ­¢æ½œåœ¨é—®é¢˜
    'no-undef': 'error', // ç¦æ­¢ä½¿ç”¨æœªå®šä¹‰çš„å˜é‡
    'no-unreachable': 'error', // é¿å…æ— æ³•åˆ°è¾¾çš„ä»£ç 
    'no-dupe-keys': 'error' // ç¦æ­¢å¯¹è±¡å­—é¢é‡ä¸­çš„é‡å¤é”®
  }
}
```

#### ğŸ˜ è§„åˆ™é›†ç®€åŒ–

é€šè¿‡ç®€åŒ–é…ç½®ï¼Œèƒ½å¤Ÿå¿«é€Ÿåº”ç”¨åŸºç¡€è§„åˆ™ï¼Œæå‡ä»£ç çš„ä¸€è‡´æ€§

```javascript
import js from '@eslint/js'
export default [js.configs.recommended]
```

### TypeScript é¡¹ç›®çš„ ESLint é…ç½®

å°† JavaScript é¡¹ç›®è¿ç§»åˆ° TypeScript é¡¹ç›®æ—¶ï¼Œæˆ‘ä»¬é‡åˆ°äº†ä¸€äº›é—®é¢˜ï¼Œä¸»è¦æ˜¯ ESLint é»˜è®¤è§„åˆ™æ— æ³•å®Œå…¨é€‚åº” TypeScript çš„ç±»å‹ç³»ç»Ÿ

ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼Œæˆ‘ä»¬å¼•å…¥äº†`@typescript-eslint/parser`è§£æ TypeScript ä»£ç ï¼Œå¹¶æ‰©å±•äº†è§„åˆ™é›†

#### TypeScript é¡¹ç›®é…ç½®

```typescript
import js from '@eslint/js'
import tsParser from '@typescript-eslint/parser'
export default [
  {
    ignores: ['eslint.config.js'],
    files: ['src/**/*.ts'],
    rules: {
      'no-console': 'error',
      'no-unused-vars': 'error',
      'no-sparse-arrays': 'error',
      'no-undef': 'error',
      'no-unreachable': 'error',
      'no-dupe-keys': 'error'
    },
    languageOptions: {
      parser: tsParser
    }
  }
]
```

#### ğŸ”” é…ç½®è¦ç‚¹

- **å¼•å…¥ TypeScript Parser**ï¼šæˆ‘ä»¬ä½¿ç”¨`@typescript-eslint/parser`æ¥æ”¯æŒ TypeScript è¯­æ³•å’Œç±»å‹æ£€æŸ¥

- **æ‰©å±•åŸºç¡€è§„åˆ™**ï¼šç»§æ‰¿äº† JavaScript é¡¹ç›®çš„è§„åˆ™ï¼Œå¹¶åŠ å…¥äº† TypeScript ç‰¹æœ‰çš„è§„åˆ™ï¼ˆå¦‚ç±»å‹å®šä¹‰çš„å¼ºåˆ¶è§„åˆ™ç­‰ï¼‰

- **å¿½ç•¥ ESLint é…ç½®æ–‡ä»¶**ï¼šé€šè¿‡`ignores`å¿½ç•¥ ESLint é…ç½®æ–‡ä»¶ï¼Œé¿å…å¾ªç¯è§£æé—®é¢˜

#### ğŸ‘ å®è·µç»éªŒ

é€šè¿‡ ESLint å’Œ TypeScript çš„ç»“åˆï¼Œæˆ‘ä»¬ä¸ä»…èƒ½æ£€æŸ¥åŸºç¡€è¯­æ³•é”™è¯¯ï¼Œè¿˜èƒ½åˆ©ç”¨ TypeScript çš„ç±»å‹ç³»ç»Ÿå‘ç°æ½œåœ¨ç±»å‹é”™è¯¯

ä¾‹å¦‚ï¼Œå£°æ˜æœªä½¿ç”¨çš„æ¥å£æˆ–ç±»å‹æ—¶ï¼Œä¼šç«‹å³æç¤ºï¼Œä»è€Œå¸®åŠ©æˆ‘ä»¬ä¿æŒæ¸…æ™°çš„ç±»å‹ç»“æ„

### Vue é¡¹ç›®çš„ ESLint é…ç½®

åœ¨è¿ç§»åˆ° Vue é¡¹ç›®æ—¶ï¼Œ`.vue` æ–‡ä»¶çš„ç‰¹æ®Šæ ¼å¼ä½¿å¾—æ ‡å‡†çš„ JavaScript å’Œ TypeScript é…ç½®æ— æ³•å®Œå…¨é€‚ç”¨

å› æ­¤ï¼Œæˆ‘ä»¬å¼•å…¥äº†`vue-eslint-parser`è§£æ Vue æ–‡ä»¶ï¼Œå¹¶ç»“åˆ`@typescript-eslint/parser`æ¥å¤„ç†å…¶ä¸­çš„ TypeScript ä»£ç 

#### Vue é¡¹ç›®é…ç½®

```javascript
import js from '@eslint/js'
import tsParser from '@typescript-eslint/parser'
import vueEslintParser from 'vue-eslint-parser'
export default [
  {
    ignores: ['eslint.config.js'],
    files: ['src/**/*.vue'],
    rules: {
      'no-console': 'error',
      'no-unused-vars': 'error',
      'no-sparse-arrays': 'error',
      'no-undef': 'error',
      'no-unreachable': 'error',
      'no-dupe-keys': 'error'
    },
    languageOptions: {
      parser: vueEslintParser,
      parserOptions: {
        extraFileExtensions: ['.vue'],
        ecmaFeatures: {
          jsx: true
        },
        parser: tsParser,
        sourceType: 'module'
      }
    }
  }
]
```

#### ğŸ”” é…ç½®è¦ç‚¹

- **Vue æ–‡ä»¶è§£æ**ï¼šæˆ‘ä»¬ä½¿ç”¨`vue-eslint-parser`æ¥è§£æ`.vue`æ–‡ä»¶ï¼Œç¡®ä¿æ¨¡æ¿ã€è„šæœ¬å’Œæ ·å¼éƒ¨åˆ†éƒ½èƒ½è¢« ESLint æ­£ç¡®åˆ†æ

- **TypeScript æ”¯æŒ**ï¼šé€šè¿‡`parserOptions`æŒ‡å®š`@typescript-eslint/parser`æ¥è§£æå…¶ä¸­çš„ TypeScript ä»£ç 

- **é¢å¤–æ–‡ä»¶æ‰©å±•**ï¼šé€šè¿‡`extraFileExtensions`é…ç½®æ¥æ”¯æŒ`.vue`æ–‡ä»¶æ ¼å¼ï¼Œç¡®ä¿ ESLint èƒ½æ­£ç¡®è¯†åˆ« Vue ç»„ä»¶

#### ğŸ‘ å®è·µç»éªŒ

é€šè¿‡`vue-eslint-parser`å’Œ`@typescript-eslint/parser`çš„åä½œï¼Œæˆ‘ä»¬èƒ½åœ¨ Vue æ–‡ä»¶ä¸­åŒæ—¶æ£€æŸ¥ JavaScript/TypeScript å’Œæ¨¡æ¿ä»£ç çš„é”™è¯¯

ä¾‹å¦‚ï¼Œæ¨¡æ¿ä¸­æœªå®šä¹‰çš„å˜é‡æˆ–è¯¯ç”¨çš„æŒ‡ä»¤ä¼šè¢«åŠæ—¶è¯†åˆ«ï¼Œé¿å…äº†ç»„ä»¶é—´å˜é‡å†²çªçš„é—®é¢˜

## æ‹†è§£ä¸€ä¸‹å®Œå¤‡å‰ç«¯ä»£ç è§„èŒƒæ ¡éªŒä¸æ ¼å¼åŒ–å·¥å…·æ¶æ„ï¼ŒåŠå¾®å†…æ ¸ä½“ç³»è®¾è®¡ â—ï¸

ESLint æ˜¯ç›®å‰æœ€æµè¡Œçš„ä»£ç æ ¡éªŒå·¥å…·ä¹‹ä¸€ï¼Œå…¶é«˜åº¦å¯é…ç½®æ€§å’Œçµæ´»çš„æ’ä»¶ç³»ç»Ÿï¼Œä½¿å¾—å¼€å‘è€…å¯ä»¥æ ¹æ®é¡¹ç›®éœ€æ±‚è‡ªå®šä¹‰ä»£ç è§„èŒƒ

å‡å¦‚æˆ‘æ˜¯ ESLint ä½œè€…ï¼Œæˆ‘åœ¨è®¾è®¡ ESLint 9 çš„æºç åŸç†å’Œè®¾è®¡æ¶æ„æ—¶ï¼Œä¼šè€ƒè™‘ä»¥ä¸‹æ¨¡å—æ‹†åˆ†ï¼ŒåŒ…æ‹¬ parserã€rulesã€plugins å’Œ languageï¼Œæœ€ç»ˆå®Œæˆ eslint æ•´ä½“å·¥ç¨‹

### ESLint 9 æ•´ä½“æ¶æ„è®¾è®¡

ESLint çš„æ•´ä½“æ¶æ„åŸºäºå¯æ‰©å±•çš„æ¨¡å—åŒ–è®¾è®¡ï¼Œå…¶æ ¸å¿ƒç»„ä»¶ä¸»è¦åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†

| éƒ¨åˆ† | åŠŸèƒ½ |
| :-- | :-- |
| æ ¸å¿ƒå¼•æ“ | è´Ÿè´£æ•´ä¸ª ESLint çš„åˆå§‹åŒ–ã€é…ç½®åŠ è½½ã€æ–‡ä»¶è§£æå’Œè§„åˆ™åº”ç”¨ |
| è§£æå™¨ï¼ˆParserï¼‰ | ESLint é€šè¿‡è§£æå™¨å°†æºä»£ç è½¬æ¢ä¸ºæŠ½è±¡è¯­æ³•æ ‘ï¼ˆASTï¼‰ï¼Œä¾¿äºè§„åˆ™å¼•æ“è¿›è¡Œé™æ€åˆ†æ |
| è§„åˆ™ï¼ˆRulesï¼‰ | è§„åˆ™ç³»ç»Ÿè´Ÿè´£æ ¹æ® AST èŠ‚ç‚¹åº”ç”¨ç‰¹å®šæ ¡éªŒé€»è¾‘ |
| æ’ä»¶ï¼ˆPluginsï¼‰ | é€šè¿‡æ’ä»¶æœºåˆ¶ï¼Œå¼€å‘è€…å¯ä»¥å¼•å…¥é¢å¤–çš„è§„åˆ™å’ŒåŠŸèƒ½ï¼Œä½¿ ESLint æ”¯æŒæ›´å¤šçš„ç¼–ç¨‹è¯­è¨€å’Œæ¡†æ¶ |
| é…ç½®ï¼ˆConfigï¼‰ | ESLint å…è®¸å¼€å‘è€…é…ç½®ä¸åŒæ–‡ä»¶ã€è§„åˆ™å’Œæ’ä»¶çš„ç»„åˆï¼Œä½¿å¾—ä»£ç æ ¡éªŒå…·æœ‰çµæ´»æ€§ |

åœ¨ ESLint 9 ä¸­ï¼Œå¯¹æ¶æ„çš„æ‰©å±•æ€§ã€æ€§èƒ½å’Œè§£æå™¨çš„å…¼å®¹æ€§è¿›è¡Œäº†è¿›ä¸€æ­¥ä¼˜åŒ–ï¼Œä»¥åº”å¯¹æ›´å¤§è§„æ¨¡å’Œå¤šæ ·æ€§çš„é¡¹ç›®éœ€æ±‚

### Parserï¼ˆè§£æå™¨ï¼‰ğŸ”„

ESLint æ”¯æŒå¤šç§è§£æå™¨ï¼Œé€šè¿‡é…ç½®ä¸åŒçš„è§£æå™¨ï¼Œä½¿å¾— ESLint ä¸ä»…é€‚ç”¨äº JavaScriptï¼Œä¹Ÿæ”¯æŒ TypeScriptã€JSXã€Flow ç­‰è¯­æ³•

ESLint çš„è§£æå™¨æ¨¡å—åŒ…æ‹¬ä»¥ä¸‹å‡ ç§å¸¸ç”¨è§£æå™¨

#### Espreeï¼šESLint çš„é»˜è®¤è§£æå™¨

> [!info] ç®€ä»‹
> Espree æ˜¯ ESLint å®˜æ–¹ç»´æŠ¤çš„ JavaScript è§£æå™¨ï¼ŒåŸºäº Acorn æ„å»º
> 
> å®ƒæ˜¯ ESLint é»˜è®¤çš„è§£æå™¨ï¼Œæ”¯æŒ ECMAScript çš„æ ‡å‡†è¯­æ³•ï¼Œé€‚ç”¨äºå¤§å¤šæ•°ç°ä»£ JavaScript é¡¹ç›®
> 
> Espree çš„ç‰¹ç‚¹æ˜¯è½»é‡ã€é«˜æ•ˆï¼Œå¹¶ä¸”ä¸ ESLint çš„å…¼å®¹æ€§æé«˜

#### Babel Parserï¼šç”¨äºæ›´å¤æ‚çš„ JavaScript è¯­æ³•

> [!info] ç®€ä»‹
> Babel Parser æ˜¯ Babel é¡¹ç›®æä¾›çš„è§£æå™¨ï¼Œç”¨äºæ”¯æŒ JSX å’Œå®éªŒæ€§è¯­æ³•ï¼Œä¾‹å¦‚è£…é¥°å™¨å’Œç§æœ‰å­—æ®µ
> 
> å¯¹äºéœ€è¦è§£æç°ä»£è¯­æ³•çš„é¡¹ç›®ï¼ˆå¦‚ä½¿ç”¨ React çš„é¡¹ç›®ï¼‰ï¼Œå¯ä»¥é€‰æ‹© Babel Parser

#### TypeScript Parserï¼šè§£æ TypeScript è¯­æ³•

> [!info] ç®€ä»‹
> å¯¹äºä½¿ç”¨ TypeScript çš„é¡¹ç›®ï¼Œ`@typescript-eslint/parser`æ˜¯æ¨èçš„è§£æå™¨
> 
> å®ƒåŸºäº TypeScript ç¼–è¯‘å™¨çš„ APIï¼Œå°† TypeScript ä»£ç è§£æä¸º ESLint å¯ç†è§£çš„ ASTï¼ŒåŒæ—¶ä¿ç•™äº† TypeScript ç‰¹æœ‰çš„ç±»å‹ä¿¡æ¯

#### è§£æå™¨çš„å·¥ä½œæµç¨‹è¯¦è§£

å½“ ESLint è¿è¡Œæ—¶ï¼Œå®ƒä¼šå…ˆè¯»å–é…ç½®æ–‡ä»¶ï¼Œæ‰¾åˆ°é€‚ç”¨äºå½“å‰æ–‡ä»¶çš„è§£æå™¨ï¼Œç„¶åä½¿ç”¨è§£æå™¨å°†ä»£ç è§£æä¸º AST

æ¥ä¸‹æ¥ï¼ŒESLint å°†åŸºäº AST åº”ç”¨è§„åˆ™

![](https://cdn.jsdelivr.net/gh/zxwin0125/image-repo@main/img/knowledge/frontEnd/engineering/specification/001.jpg){width=600}

### Rulesï¼ˆè§„åˆ™ï¼‰ğŸš«

è§„åˆ™æ˜¯ ESLint æ ¸å¿ƒçš„ç»„æˆéƒ¨åˆ†ï¼Œæ¯ä¸€ä¸ªè§„åˆ™è´Ÿè´£æ£€æµ‹ä»£ç ä¸­çš„ç‰¹å®šæ¨¡å¼å¹¶å‘å‡ºè­¦å‘Šæˆ–é”™è¯¯

ESLint çš„è§„åˆ™ç³»ç»Ÿæœ‰ä»¥ä¸‹å‡ ä¸ªç‰¹ç‚¹

> [!tip]  ç‰¹ç‚¹è§£æ
> è§„åˆ™ç±»å‹
> - ESLint å†…ç½®äº†è®¸å¤šå¸¸ç”¨çš„è§„åˆ™ï¼Œä¾‹å¦‚ä»£ç é£æ ¼è§„åˆ™ï¼ˆå¦‚ç¼©è¿›ã€åˆ†å·ä½¿ç”¨ï¼‰å’Œæœ€ä½³å®è·µè§„åˆ™ï¼ˆå¦‚é¿å…ä½¿ç”¨æœªå®šä¹‰å˜é‡ï¼‰
> 
> è§„åˆ™é…ç½®
> - æ¯ä¸ªè§„åˆ™å¯ä»¥å•ç‹¬é…ç½®ä¸¥é‡ç¨‹åº¦ï¼ˆoffã€warnã€errorï¼‰ï¼Œå¹¶å¯ä»¥æ ¹æ®é¡¹ç›®éœ€è¦è®¾å®šè§„åˆ™å‚æ•°
> 
> è‡ªå®šä¹‰è§„åˆ™
> - ESLint å…è®¸ç”¨æˆ·ç¼–å†™è‡ªå®šä¹‰è§„åˆ™æ¥æ‰©å±•ä»£ç æ ¡éªŒåŠŸèƒ½ï¼Œæ»¡è¶³ç‰¹å®šçš„é¡¹ç›®éœ€æ±‚

æ¯ä¸ªè§„åˆ™é€šå¸¸åŒ…å«ä¸¤ä¸ªéƒ¨åˆ†

- **meta**ï¼šæè¿°è§„åˆ™çš„å…ƒæ•°æ®ï¼ŒåŒ…æ‹¬æè¿°ã€æ–‡æ¡£é“¾æ¥å’Œå»ºè®®

- **create å‡½æ•°**ï¼šè§„åˆ™çš„æ ¸å¿ƒé€»è¾‘ï¼Œåœ¨ AST éå†è¿‡ç¨‹ä¸­ï¼Œç›‘å¬ç‰¹å®šèŠ‚ç‚¹å¹¶è¿›è¡Œæ ¡éªŒ

#### è§„åˆ™çš„åº”ç”¨æœºåˆ¶

åœ¨ ESLint çš„è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œæ ¸å¿ƒå¼•æ“ä¼šåŸºäºè§£æå™¨ç”Ÿæˆçš„ AST éå†æ‰€æœ‰èŠ‚ç‚¹ï¼Œå¹¶åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šåº”ç”¨å·²é…ç½®çš„è§„åˆ™

æ¯å½“ä¸€ä¸ªèŠ‚ç‚¹ä¸ç¬¦åˆæŸä¸ªè§„åˆ™æ—¶ï¼ŒESLint ä¼šæŠ¥å‘Šä¸€ä¸ªè­¦å‘Šæˆ–é”™è¯¯

### Pluginsï¼ˆæ’ä»¶ï¼‰âš™ï¸

æ’ä»¶æ˜¯ ESLint çš„æ‰©å±•æœºåˆ¶ï¼Œå…è®¸ç”¨æˆ·åœ¨é»˜è®¤è§„åˆ™ä¹‹å¤–å¼•å…¥è‡ªå®šä¹‰åŠŸèƒ½ï¼Œæ’ä»¶å¯ä»¥åŒ…å«å¤šä¸ªè§„åˆ™ã€å…±äº«é…ç½®ã€ç¯å¢ƒå®šä¹‰ç­‰ï¼Œæ–¹ä¾¿åœ¨ä¸åŒé¡¹ç›®ä¸­å¤ç”¨

ä¸€ä¸ªæ’ä»¶é€šå¸¸åŒ…å«ä»¥ä¸‹å†…å®¹

- **rules**ï¼šæ’ä»¶ä¸­å®šä¹‰çš„ä¸€ç»„è§„åˆ™ï¼Œå¯ä»¥åœ¨é¡¹ç›®ä¸­å•ç‹¬å¼•å…¥

- **processors**ï¼šç”¨äºå¯¹ç‰¹æ®Šæ–‡ä»¶ç±»å‹ï¼ˆå¦‚ Markdownã€Vue æ–‡ä»¶ï¼‰è¿›è¡Œé¢„å¤„ç†

- **é…ç½®**ï¼šæ’ä»¶å¯ä»¥æä¾›é¢„å®šä¹‰çš„é…ç½®ç»„åˆï¼Œä¾¿äºå¿«é€Ÿé…ç½®è§„åˆ™é›†

åœ¨ ESLint çš„é…ç½®æ–‡ä»¶ä¸­ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡`plugins`å±æ€§å¼•å…¥æ’ä»¶ï¼Œç„¶åé€šè¿‡`rules`é…ç½®å¯ç”¨æ’ä»¶ä¸­çš„ç‰¹å®šè§„åˆ™

### Languageï¼ˆè¯­è¨€ï¼‰

åœ¨ ESLint 9 ä¸­ï¼Œå¢åŠ äº†å¯¹å¤šè¯­è¨€æ”¯æŒçš„ä¼˜åŒ–

é€šè¿‡æ’ä»¶æœºåˆ¶ï¼ŒESLint æ”¯æŒ JavaScriptã€TypeScriptã€JSX ç­‰å¸¸è§çš„å‰ç«¯è¯­è¨€ï¼ŒåŒæ—¶æ”¯æŒ Markdownã€JSON ç­‰æ–‡ä»¶çš„æ ¡éªŒ

ä¸ºä¸åŒè¯­è¨€æä¾›äº†çµæ´»çš„è§£æå™¨é…ç½®ï¼Œä½¿ ESLint æˆä¸ºä¸€ä¸ªå¤šè¯­è¨€é™æ€åˆ†æå¹³å°

### ESLint æ’ä»¶å¼€å‘

ä¸ºäº†è¯´æ˜å¦‚ä½•å¼€å‘è‡ªå®šä¹‰ ESLint æ’ä»¶ï¼Œä¸‹é¢é€šè¿‡ä¸€ä¸ªå®é™…ç¤ºä¾‹ï¼šåˆ›å»ºä¸€ä¸ªè§„åˆ™ï¼Œé¿å…å˜é‡ååŒ…å«ç‰¹å®šè¯æ±‡ï¼ˆå¦‚`zxwin`ï¼‰

#### ç¤ºä¾‹ 1ï¼šè‡ªå®šä¹‰ ESLint è§„åˆ™å’Œæ’ä»¶

1. **åˆ›å»ºè‡ªå®šä¹‰è§„åˆ™`avoid-name-zxwin.js`**

```javascript
export const avoidNamezxwinRule = {
  meta: {
    messages: {
      avoidName: "Avoid using variables named '{{ name }}'"
    }
  },
  create(context) {
    return {
      Identifier(node) {
        if (node.name === 'zxwin') {
          context.report({
            node,
            messageId: 'avoidName',
            data: {
              name: 'zxwin'
            }
          })
        }
      }
    }
  }
}
```

è¿™é‡Œå®šä¹‰äº†ä¸€ä¸ªåä¸º`avoidNamezxwinRule`çš„è§„åˆ™ï¼Œæ£€æµ‹ AST ä¸­çš„å˜é‡åæ˜¯å¦ä¸º`zxwin`ï¼Œè‹¥åŒ¹é…åˆ™è§¦å‘`context.report`æŠ¥å‘Šé”™è¯¯

1. **åˆ›å»ºæ’ä»¶å…¥å£æ–‡ä»¶`eslint-zxwin-plugin.js`**

```javascript
import { avoidNamezxwinRule } from '../rules/avoid-name-zxwin.js'

export const eslintzxwinPlugin = {
  rules: {
    'avoid-name': avoidNamezxwinRule
  }
}
```

å°†è‡ªå®šä¹‰è§„åˆ™æ³¨å†Œåˆ°æ’ä»¶`eslintzxwinPlugin`ä¸­ï¼Œä»¥ä¾¿åœ¨ ESLint é…ç½®ä¸­ä½¿ç”¨

<!-- â¤ï¸æˆ‘ä»¬æè¿‡éå¸¸å¤šæ¬¡å…³äºæ’ä»¶åŒ–æ€æƒ³çš„å®è·µï¼ŒVIP è¯¾ç¨‹å†…å®¹æœ‰è¯¦ç»†æ’ä»¶åŒ–æ€æƒ³å®è·µç¤ºä¾‹ï¼Œä¸»æµå‰ç«¯æ¡†æ¶å‡ ä¹éƒ½æ˜¯é‡‡ç”¨æ­¤å¾®å†…æ ¸ï¼ˆæ’ä»¶åŒ–æœºåˆ¶ï¼‰æ¶æ„ã€‚ -->

1. **é…ç½® ESLint ä½¿ç”¨è‡ªå®šä¹‰æ’ä»¶`eslint.config.js`**

```javascript
import { eslintzxwinPlugin } from './plugins/eslint-zxwin-plugin.js'

export default [
  {
    files: ['src/**/*.js'],
    plugins: {
      zxwin: eslintzxwinPlugin
    },
    rules: {
      'zxwin/avoid-name': 'error'
    }
  }
]
```

#### ç¤ºä¾‹ 2ï¼šè‡ªå®šä¹‰ ESLint è§„åˆ™`no-debugger`æ’ä»¶

1. **åˆ›å»ºè‡ªå®šä¹‰è§„åˆ™`no-debugger.js`**

```javascript
export const noDebuggerRule = {
  meta: {
    messages: {
      noDebugger: 'Avoid using debugger statements.'
    }
  },
  create(context) {
    return {
      DebuggerStatement(node) {
        context.report({
          node,
          messageId: 'noDebugger'
        })
      }
    }
  }
}
```

æ­¤è§„åˆ™ç”¨äºæ£€æµ‹ä»£ç ä¸­çš„`debugger`è¯­å¥ï¼Œå¹¶ç”ŸæˆæŠ¥å‘Šæç¤ºï¼Œé¿å…åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨`debugger`

1. **åˆ›å»ºæ’ä»¶å…¥å£æ–‡ä»¶`eslint-debugger-plugin.js`**

```javascript
import { noDebuggerRule } from '../rules/no-debugger.js'

export const eslintDebuggerPlugin = {
  rules: {
    'no-debugger': noDebuggerRule
  }
}
```

è¯¥æ’ä»¶æ³¨å†Œäº†`no-debugger`è§„åˆ™ï¼Œä»¥ä¾¿ ESLint åœ¨æ£€æŸ¥ä»£ç æ—¶èƒ½æœ‰æ•ˆç¦ç”¨`debugger`è¯­å¥

1. **é…ç½® ESLint ä½¿ç”¨è‡ªå®šä¹‰æ’ä»¶`eslint.config.js`**

```javascript
import { eslintDebuggerPlugin } from './plugins/eslint-debugger-plugin.js'

export default [
  {
    files: ['src/**/*.js'],
    plugins: {
      debugger: eslintDebuggerPlugin
    },
    rules: {
      'debugger/no-debugger': 'warn'
    }
  }
]
```

åœ¨ ESLint é…ç½®æ–‡ä»¶ä¸­å¼•å…¥æ’ä»¶`debugger`ï¼Œå¹¶å¯ç”¨`no-debugger`è§„åˆ™

### è¯´æ˜æ–‡æ¡£

#### æ’ä»¶å¼€å‘æ­¥éª¤

1. **ç¼–å†™è§„åˆ™**ï¼šåˆ›å»ºä¸€ä¸ª JavaScript æ–‡ä»¶ï¼Œç¼–å†™è‡ªå®šä¹‰çš„ ESLint è§„åˆ™æ¯ä¸ªè§„åˆ™éƒ½åº”éµå¾ª ESLint çš„è§„èŒƒï¼ŒåŒ…å«`meta`å’Œ`create`æ–¹æ³•ï¼Œ`create`æ–¹æ³•ç”¨äºå®šä¹‰è§„åˆ™çš„å…·ä½“å®ç°

2. **åˆ›å»ºæ’ä»¶**ï¼šå°†ä¸€ä¸ªæˆ–å¤šä¸ªè§„åˆ™æ³¨å†Œåˆ°æ’ä»¶å¯¹è±¡çš„`rules`å±æ€§ä¸­ï¼Œä»¥ä¾¿åœ¨ ESLint é…ç½®æ–‡ä»¶ä¸­ä½¿ç”¨

3. **é…ç½® ESLint**ï¼šåœ¨ ESLint é…ç½®æ–‡ä»¶ä¸­å¼•å…¥æ’ä»¶å¹¶é…ç½®ä½¿ç”¨çš„è§„åˆ™ï¼Œè®¾ç½®è§„åˆ™çš„çº§åˆ«ï¼ˆå¦‚`error`æˆ–`warn`ï¼‰

#### æ’ä»¶æœ€ä½³å®è·µ

- **å‘½åè§„èŒƒ**ï¼šæ’ä»¶å’Œè§„åˆ™åº”æœ‰æ¸…æ™°ã€æè¿°æ€§çš„å‘½åï¼Œé¿å…ä¸å·²æœ‰æ’ä»¶æˆ–è§„åˆ™å†²çª

- **æŠ¥é”™ä¿¡æ¯**ï¼šåœ¨è§„åˆ™çš„`meta`é…ç½®ä¸­ä½¿ç”¨æœ‰æ„ä¹‰çš„é”™è¯¯ä¿¡æ¯ï¼Œå¸®åŠ©å¼€å‘äººå‘˜æ›´å¥½åœ°ç†è§£é—®é¢˜å’Œè§£å†³æ–¹æ³•

- **å…¼å®¹æ€§**ï¼šç¡®ä¿è§„åˆ™å’Œæ’ä»¶å…¼å®¹å„ç§å¸¸è§çš„ JavaScript è¯­æ³•å’Œæ¡†æ¶

é€šè¿‡è¿™äº›ç¤ºä¾‹å’Œæœ€ä½³å®è·µï¼Œä½ å¯ä»¥è½»æ¾åˆ›å»ºå¹¶ä½¿ç”¨è‡ªå®šä¹‰ ESLint æ’ä»¶æ¥å¸®åŠ©å›¢é˜Ÿç»´æŠ¤ä»£ç è´¨é‡

åœ¨ ESLint é…ç½®æ–‡ä»¶ä¸­å¼•å…¥`miaoma`æ’ä»¶ï¼Œå¹¶å¯ç”¨`avoid - name`è§„åˆ™
